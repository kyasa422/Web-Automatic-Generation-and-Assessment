import{j as t}from"./app-BS3kFj9k.js";import{u as d,w as f}from"./xlsx-DjuO7_Ju.js";import"./flowbite.min-BWEkewtM.js";import{d as g}from"./index-BnOs0bKj.js";const v=({laporanPengeluaranCabang:c,bulan:r,tahun:m,nextMonth:h,nextYear:k,prevMonth:b,prevYear:p})=>{const n=(a,i)=>{g.Inertia.get(route("admin.rekap.cabang"),{bulan:a,tahun:i})},l=a=>c.data.reduce((i,x)=>i+(x[a]||0),0),j=(a,i)=>{const x=a.data.map(e=>({Hari:e.hari,Tanggal:e.tanggal,Cabang:e.cabang?e.cabang.nama:"N/A","Nama Guru":e.user?e.user.name:"N/A",Gaji:e.gaji||0,ATK:e.atk||0,Sewa:e.sewa||0,Intensif:e.intensif||0,Lisensi:e.lisensi||0,THR:e.thr||0,"Lain Lain":e.lainlain||0,Total:e.totalpengeluaran||0})),w={Hari:"Total",Tanggal:"",Cabang:"","Nama Guru":"",Gaji:x.reduce((e,s)=>e+s.Gaji,0),ATK:x.reduce((e,s)=>e+s.ATK,0),Sewa:x.reduce((e,s)=>e+s.Sewa,0),Intensif:x.reduce((e,s)=>e+s.Intensif,0),Lisensi:x.reduce((e,s)=>e+s.Lisensi,0),THR:x.reduce((e,s)=>e+s.THR,0),"Lain Lain":x.reduce((e,s)=>e+s["Lain Lain"],0),Total:x.reduce((e,s)=>e+s.Total,0)};x.push(w);const N=d.json_to_sheet(x),o=d.book_new();d.book_append_sheet(o,N,"Pengeluaran");const y=`Rekap_Pengeluaran_cabang_${i}.xlsx`;f(o,y)};return t.jsxs("div",{className:"col-span-12 rounded-sm border border-stroke bg-white py-6 shadow-default dark:border-strokedark dark:bg-boxdark mt-20",children:[t.jsxs("div",{className:"flex justify-between px-7.5 mb-6",children:[t.jsxs("h4",{className:"text-xl font-semibold text-black dark:text-white",children:["Rekap Pengeluaran Cabang - ",r," ",m]}),t.jsx("div",{children:t.jsx("button",{onClick:()=>j(c,`${r} / ${m}`),className:"bg-green-500 text-white px-4 py-2 rounded ml-2 hover:bg-green-600",children:"Download Excel"})})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full table-auto",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-2 dark:bg-meta-4",children:[t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white pl-10",children:"Hari"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Tanggal"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Cabang"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Nama Guru"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Gaji"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"ATK"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Sewa"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Intensif"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Lisensi"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"THR"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Lain Lain"}),t.jsx("th",{className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white",children:"Total"})]})}),t.jsx("tbody",{children:c.data.map((a,i)=>t.jsxs("tr",{className:"border-b border-stroke dark:border-strokedark",children:[t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white pl-10",children:a.hari}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:a.tanggal}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:a.cabang?a.cabang.nama:"N/A"}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:a.user?a.user.name:"N/A"}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:a.gaji.toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:a.atk.toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:a.sewa.toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:a.intensif.toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:a.lisensi.toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:a.thr.toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:a.lainlain.toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:a.totalpengeluaran.toLocaleString()})]},i))}),t.jsx("tfoot",{children:t.jsxs("tr",{className:"bg-gray-2 dark:bg-meta-4 font-semibold",children:[t.jsx("td",{colSpan:"4",className:"py-4 px-4 text-left text-sm font-medium text-black dark:text-white pl-10",children:"Total"}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:l("gaji").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:l("atk").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:l("sewa").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:l("intensif").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:l("lisensi").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:l("thr").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:l("lainlain").toLocaleString()}),t.jsx("td",{className:"py-4 px-4 text-sm text-black dark:text-white",children:l("totalpengeluaran").toLocaleString()}),t.jsx("td",{className:"py-4 px-4"})]})})]})}),t.jsxs("div",{className:"flex justify-center gap-3 mt-4",children:[t.jsx("button",{onClick:()=>n(b,p),className:"py-2 px-4 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Sebelumnya"}),t.jsx("button",{onClick:()=>n(h,k),className:"py-2 px-4 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Selanjutnya"})]})]})};export{v as default};
